<?php $__env->startSection('css'); ?>


    <style>
        .row{
            margin:2px;
        }
        .btn{
            min-width: 80px;
        }
    </style>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('content'); ?>
    <div class="container-fluid">
        <div class="border">
            <form method="GET" action="<?php echo e(url('/gsu/dial-up/search')); ?>" name="form_search">
                <div class="row">
                    <div class="col-md-1 soggetto">CLIENTE</div>
                    <div class="col-md-2"><input type="text" value="<?php echo e(Input::get('cliente')); ?>" id="cliente" name="cliente" placeholder="CLIENTE"></div>
                    <div class="col-md-1 cliente">CLIENTE FINALE</div>
                    <div class="col-md-2"><input type="text" value="<?php echo e(Input::get('cliente_finale')); ?>" id="cliente_finale" name="cliente_finale" placeholder="CLIENTE FINALE"></div>
                    <div class="col-md-2 destinatarioabituale">UBICAZIONE IMPIANTO</div>
                    <div class="col-md-2"><input type="text" value="<?php echo e(Input::get('ubicazione')); ?>" id="ubicazione" name="ubicazione" placeholder="UBICAZIONE IMPIANTO"></div>
                    <div class="col-md-3"></div>
                </div>
                <div class="row">
                    <div class="col-md-1">CANONE</div>
                    <div class="col-md-2"><input type="text" value="<?php echo e(Input::get('canone')); ?>" id="canone" name="canone" placeholder="CANONE"></div>
                    <div class="col-md-1">MANUTENZIONE</div>
                    <div class="col-md-2"><input type="text" value="<?php echo e(Input::get('manutenzione')); ?>" id="manutenzione" name="manutenzione" placeholder="MANUTENZIONE"></div>
                    <div class="col-md-2">DATA INIZIO CONTRATTO</div>
                    <div class="col-md-2"><input type="text" value="<?php echo e(Input::get('data_contratto')); ?>" id="data_contratto" name="data_contratto" class="datepicker" placeholder="DATA INIZIO CONTRATTO"></div>
                    <div class="col-md-3"></div>
                </div>
                <div class="row">
                    <div class="col-md-1">CONNESSIONE</div>
                    <div class="col-md-2"><input type="text" value="<?php echo e(Input::get('connessione')); ?>" id="connessione" name="connessione" placeholder="CONNESSIONE"></div>
                    <div class="col-md-1">TIPO CONNESSIONE</div>
                    <div class="col-md-2"><input type="text" value="<?php echo e(Input::get('tipo_connessione')); ?>" id="tipo_connessione" name="tipo_connessione" placeholder="TIPO CONNESSIONE"></div>
                    <div class="col-md-2">IP</div>
                    <div class="col-md-2"><input type="text" value="<?php echo e(Input::get('ip')); ?>" id="ip" name="ip" placeholder="IP"></div>
                    <div class="col-md-3"></div>
                </div>
                <div class="row">
                    <div class="col-md-2"><input type="submit" value="CERCA" id="cerca" name="cerca" class="btn btn-primary btn-xs"></div>
                    <div class="col-md-offset-8"><input type="button" value="REIMPOSTA" id="reimposta" name="reimposta" class="btn btn-default btn-xs"></div>

                </div>
            </form>
        </div>
    </div>

    <br>

    <div class="row" id="loader">
        <div class="col-md-2"><img src="<?php echo e(URL::asset('images/loader.gif')); ?>"></div>
    </div>

    <table id="main" class="table table-striped table-bordered display" cellspacing="0" width="100%" style="display:none;">
        <thead>
        <tr>
            <th class="col-sm-1">AZIONI</th>
            <th class="col-sm-1">MANTUTENZIONE</th>
            <th class="col-sm-1">DATA INIZIO CONTRATTO</th>
            <th class="col-sm-1">CANONE</th>
            <th class="col-sm-2">CLIENTE</th>
            <th class="col-sm-2">CLIENTE FINALE</th>
            <th class="col-sm-2">UBICAZIONE</th>
            <th class="col-sm-2">CONNESSIONE</th>
            <th class="col-sm-2">TIPO CONNESSIONE</th>
            <th class="col-sm-1">IP</th>
            <th class="col-sm-1">NOTE</th>
        </tr>
        </thead>

        <tbody>
        <?php foreach($request as $req): ?>
            <tr>
                <td>
                    <a class="btn btn-small edit" href="<?php echo e(url('/gsu/dial-up/edit')."?id=".$req['IDDIALUP']); ?>" title="EDIT"><i class="glyphicon glyphicon-pencil"></i> </a>
                    <a class="btn btn-small edit delete" href="javascript:void();" data-toggle="modal" title="DELETE" manutenzione="<?php echo e(isset($req['MANUTENZIONE']) ? $req['MANUTENZIONE'] : ""); ?>" delete-id="<?php echo e(isset($req['IDDIALUP']) ? $req['IDDIALUP'] : ""); ?>"><i class="glyphicon glyphicon-trash"></i> </a>
                </td>
                <td><a href="<?php echo e(url($class['link'][$req['CANONE']])."/show?manutenzione=".$req['MANUTENZIONE']."&id=".$req['IDDIALUP']); ?>"><?php echo e($req['MANUTENZIONE']); ?></a></td>
                <td><?php echo e($req['DATADOCUMENTO']); ?></td>
                <td><?php echo e($req['CANONE']); ?></td>
                <td><?php echo e($req['SOGGETTO']); ?></td>
                <td><?php echo e($req['CLIENTE']); ?></td>
                <td><?php echo e($req['DESTINATARIOABITUALE']); ?></td>
                <td><?php echo e($req['CONNESSIONE']); ?></td>
                <td><?php echo e($req['TIPO_CONNESSIONE']); ?></td>
                <td><?php echo e($req['IP']); ?></td>
                <td><?php echo e($req['NOTE']); ?></td>
            </tr>
        <?php endforeach; ?>
        </tbody>

        <?php if(Input::get('add') == 1): ?>
            <tfoot>
            <tr>
                <th colspan="11"><a class="btn btn-small edit" href="<?php echo e(url('/gsu/dial-up/edit')."?isnew=1&manutenzione=".$req['MANUTENZIONE']); ?>" title="ADD NEW"><i class="glyphicon glyphicon-plus"></i>&nbsp; ADD NEW </a></th>
            </tr>
            </tfoot>
        <?php endif; ?>
    </table>




    <div id="delete" class="modal fade" style="z-index:99999;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Eliminare il record selezionato ?</h4>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Annulla</button>
                    <button type="button" class="btn btn-primary" id="btn_elimina">ELIMINA</button>
                </div>
            </div>
        </div>
    </div>

<?php $__env->stopSection(); ?>



<?php $__env->startSection('script'); ?>

    <script type="text/javascript">
        $(document).ready(function () {
            var id_elimina;
            var manutenzione;

            $('#main').dataTable({
                "iDisplayLength": 30,
                "lengthMenu": [[10, 30, 50, -1], [10, 30, 50, "All"]],
                "aaSorting": [],
                "fnInitComplete": function(oSettings, json) {
                    $("#loader").hide();
                    $("#main").show();
                }
            });

            $("#reimposta").click(function(){
               $("input[type=text]").val("");
                $("input[type=checkbox]").attr("checked", false);
            });

            $( ".datepicker" ).datepicker({ dateFormat: 'dd-mm-yy' });


            $(".delete").click(function(){
                id_elimina = $(this).attr('delete-id');
                manutenzione = $(this).attr('manutenzione');
                $('#delete').modal('show');
            });



            $("#btn_elimina").click(function(){
                $.get( "<?php echo e(url('/gsu/dial-up/delete')); ?>", { id: id_elimina, manutenzione: manutenzione } )
                        .done(function( data ) {
                            $("#delete").modal('toggle');
                            $("#cerca").trigger("click");
                        });
            });

        });
    </script>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('gsu::app', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>